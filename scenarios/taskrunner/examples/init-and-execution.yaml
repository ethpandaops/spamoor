# Example with initialization and execution phases
# Sets up a factory contract in init, then uses it to create tokens

init:
  # Deploy a simple factory contract during initialization
  - type: deploy
    name: factory
    data:
      # Simple factory that creates contracts
      contract_code: "0x608060405234801561001057600080fd5b50610200806100206000396000f3fe608060405234801561001057600080fd5b506004361061002b5760003560e01c80629e3e6814610030575b600080fd5b61004a60048036038101906100459190610123565b61004c565b005b6000808260405161005c906100f7565b61006691906101af565b604051809103906000f08015801561008257816001600160a01b03165a03f35b50905050565b6000604051905090565b600080fd5b600080fd5b6000819050919050565b6100b0816100a3565b81146100bb57600080fd5b50565b6000813590506100cd816100a7565b92915050565b6000602082840312156100e9576100e861009e565b5b60006100f7848285016100be565b91505092915050565b600061010b90610104565b9050919050565b7f6080604052348015600f57600080fd5b50600080fd5b6000819050919050565b61013e81610131565b811461014957600080fd5b50565b60008135905061015b81610135565b92915050565b60006020828403121561017757610176610092565b5b60006101858482850161014c565b91505092915050565b6101978161009f565b82525050565b60006020820190506101b2600083018461018e565b9291505056fea26469706673582212203b1f8a9c7e6d5a4b3c2f1e0d9c8b7a6958473625142036495867b4c3a2918f0064736f6c63430008070033"
      gas_limit: 500000

execution:
  # Use the factory to create new contracts each cycle
  - type: call
    name: create_contract
    data:
      target: "{contract:factory}"
      # Call create function with random salt
      call_data: "0x9e3e6814{random:32}"  # create(uint256 salt)
      gas_limit: 200000

  # Deploy an independent contract as well
  - type: deploy
    name: token
    data:
      # Simple ERC20-like token
      contract_code: "0x608060405234801561001057600080fd5b5060006020848285016100be565b91505092915050565b6100978161009f565b82525050565b60006020820190506101b2600083018461018e565b9291505056fea26469706673582212203b1f8a9c7e6d5a4b3c2f1e0d9c8b7a6958473625142036495867b4c3a2918f0064736f6c63430008070033"
      gas_limit: 300000